snapshots:
  - name: dim_listings
    relation: ref('listings') # Source table reference
    config:
      database: AIRBNB
      schema: gold
      unique_key: listing_id # Unique identifier for each record to apply SCD type 2 logic
      strategy: timestamp 
      updated_at: listings_created_at # Column to track changes
      dbt_valid_to_current: "to_date('9999-12-31')" # Default end date for current records

